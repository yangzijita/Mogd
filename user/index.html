<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>蘑菇丁打卡</title>
    <meta name="description" content="蘑菇丁打卡">
    <meta name="keywords" content="index">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="icon" type="image/png" href="assets/i/favicon.png">
    <link rel="apple-touch-icon-precomposed" href="assets/i/app-icon72x72@2x.png">
    <meta name="apple-mobile-web-app-title" content="蘑菇丁打卡" />
    <script src="assets/js/echarts.min.js"></script>
    <link rel="stylesheet" href="assets/css/amazeui.min.css" />
    <link rel="stylesheet" href="assets/css/amazeui.datatables.min.css" />
    <link href="http://cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/app.css">
    <script type="text/javascript" src="http://cdn.bootcss.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="assets/js/jquery.min.js"></script>
    <link rel="stylesheet" href="../css/sweetalert.css">
    <script src="../js/sweetalert-dev.js"></script>


    <script>
        $(function () {
            $.ajax({
                url: "/../IndexViews/User/",//ajax请求要发送的地址
                dataType: "json",//响应数据的类型
                type: "POST",//发送请求的方式
                success: function (data) {
                    //data为服务器端响应的数据
                    rs = data;
                    if (rs.status == "400") {
                        window.location.href = "../login.html";
                    } else if (rs.status == "200") {
                        // alert('ok');
                    }
                }
            });
        })
        $(function () {
            $.ajax({
                url: "/../IndexViews/UserInfo/",//ajax请求要发送的地址
                dataType: "json",//响应数据的类型
                type: "POST",//发送请求的方式
                success: function (data) {
                    //data为服务器端响应的数据
                    rs = data;
                    if (rs.status == "400") {
                        // window.location.href = "../login.html";
                        console.log('当前未登录');
                    } else if (rs.status == "200") {
                        // alert('ok');
                        // console.log(rs);
                        // console.log(rs.data.QQimg);
                        $("#imgqq").attr('src', rs.data.QQimg);
                        $("#idname").text(rs.data.phone);
                        $("#idname1").text(rs.data.phone);

                    }
                }
            });
        })




    </script>
</head>

<body data-type="index">
    <script src="assets/js/theme.js"></script>
    <div class="am-g tpl-g">
        <!-- 头部 -->
        <header>
            <!-- logo -->
            <div class="am-fl tpl-header-logo">
                <a href="javascript:;"><img src="http://520.lyscholar.cn/log.png" alt=""></a>
            </div>
            <!-- 右侧内容 -->
            <div class="tpl-header-fluid">
                <!-- 侧边切换 -->
                <div class="am-fl tpl-header-switch-button am-icon-list">
                    <span>

                    </span>
                </div>
                <!-- 搜索 -->
                <div class="am-fl tpl-header-search">
                    <form class="tpl-header-search-form" action="javascript:;">
                        <button class="tpl-header-search-btn am-icon-search"></button>
                        <input class="tpl-header-search-box" type="text" placeholder="搜索内容...">
                    </form>
                </div>
                <!-- 其它功能-->
                <div class="am-fr tpl-header-navbar">
                    <ul>
                        <!-- 欢迎语 -->
                        <li class="am-text-sm tpl-header-navbar-welcome">
                            <a href="javascript:;">欢迎你, <span id="idname">admin</span> </a>
                        </li>



                        <!-- 退出 -->
                        <li class="am-text-sm">
                            <a href="/../IndexViews/LoginOut/">
                                <span class="am-icon-sign-out">退出</span>
                            </a>

                        </li>
                    </ul>
                </div>
            </div>

        </header>
        <!-- 风格切换 -->
        <div class="tpl-skiner">
            <div class="tpl-skiner-toggle am-icon-cog">
            </div>
            <div class="tpl-skiner-content">
                <div class="tpl-skiner-content-title">
                    选择主题
                </div>
                <div class="tpl-skiner-content-bar">
                    <span class="skiner-color skiner-white" data-color="theme-white"></span>
                    <span class="skiner-color skiner-black" data-color="theme-black"></span>
                </div>
            </div>
        </div>
        <!-- 侧边导航栏 -->
        <div class="left-sidebar">
            <!-- 用户信息 -->
            <div class="tpl-sidebar-user-panel">
                <div class="tpl-user-panel-slide-toggleable">
                    <div class="tpl-user-panel-profile-picture">
                        <img id="imgqq" src="assets/img/user04.png" alt="">
                    </div>
                    <span class="user-panel-logged-in-text">
                        <i class="am-icon-circle-o am-text-success tpl-user-panel-status-icon"></i>
                        <span id="idname1">禁言小张</span>
                    </span>
                    <a href="javascript:;" class="tpl-user-panel-action-link"> <span class="am-icon-pencil"></span>
                        账号设置</a>
                </div>
            </div>

            <!-- 菜单 -->
            <ul class="sidebar-nav">
                <!-- <li class="sidebar-nav-heading">Components <span class="sidebar-nav-heading-info"> 附加组件</span></li> -->
                <li class="sidebar-nav-link">
                    <a href="index.html" class="active">
                        <i class="am-icon-home sidebar-nav-link-logo"></i> 首页
                    </a>
                </li>
                <li class="sidebar-nav-link">
                    <a href="table-list.html">
                        <i class="am-icon-table sidebar-nav-link-logo"></i> 任务
                    </a>
                </li>
            </ul>
        </div>


        <!-- 内容区域 -->
        <div class="tpl-content-wrapper">
            <div class="container-fluid am-cf">
                <!-- <div class="row">
                    <div class="am-u-sm-12 am-u-md-12 am-u-lg-9">
                        <div class="page-header-heading"><span class="am-icon-home page-header-heading-icon"></span>
                            部件首页 <small>Amaze UI</small></div>
                        <p class="page-header-description">Amaze UI 含近 20 个 CSS 组件、20 余 JS 组件，更有多个包含不同主题的 Web 组件。</p>
                    </div>
                    <div class="am-u-lg-3 tpl-index-settings-button">
                        <button type="button" class="page-header-button"><span class="am-icon-paint-brush"></span>
                            设置</button>
                    </div> -->
                <form class="form-horizontal" id="form">
                    <div class="form-group">
                        <label class="col-sm-2 control-label">产品名称</label>
                        <div class="col-sm-4">
                            <select name="pName" class="form-control" id="pName" required="true"
                                required-message="请选择产品时间">
                                <option value="18">test(18)</option>
                                <option value="35">test(35)</option>
                                <option value="50">test3(50)</option>
                            </select>
                        </div>
                    </div>
                    <!-- <div class="form-group">
                        <label class="col-sm-2 control-label">产品数量</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" name="pNum" check-type="number"
                                check-type-msg="请输入数值" />
                        </div>
                    </div> -->
                    <div class="form-group">
                        <label class="col-sm-2 control-label">产品类型</label>
                        <div class="col-sm-4">
                            <select name="pType" class="form-control" id="pType" required="true"
                                required-message="请选择产品时间">
                                <option value="999">test</option>
                                <option value="888">test1</option>
                                <option value="666">test2</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-2"></div>
                        <div class="col-sm-4">
                            <input type="button" class="main1" id="form-submit" value="购 买" />
                            <div class="qrcode" style="display: none;">
                                <img class="image" width="100%" height="100%" src="test" alt="点击购买扫描二维码" />
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <script>
                // $(".image").error(function () {
                //     $(".image").replaceWith("<p><b>二维码未加载！</b></p>");
                // });
                $("#form-submit").click(function () {
                    var dic = {
                        price: $("#pName option:selected").val(),
                        notice: $("#pType option:selected").val(),
                    };
                    // console.log(dic);

                    // console.log(dic);
                    // 将获取的字符串转换为 json数据
                    var msg = JSON.stringify(dic);
                    // var $test = $(".test");
                    // ajax发送

                    $.ajax({
                        // 发送到的地址
                        url: "/../IndexViews/CreatePay/",
                        //请求方式
                        type: "post",
                        //指定请求的数据格式为json
                        contentType: "application/json",
                        // 数据
                        data: msg,
                        //指定响应的格式为json,注意如果后台没有放回json类型的数据格式下方的success不会执行
                        dataType: "json",
                        success: function (res) {
                            console.log(res);
                            var data = res;
                            if (data.status == 200) {

                                console.log(res);
                                // alert();
                                let urlimg = data.data[0].url;
                                //     console.log(urlimg);
                                // alert(<img src='urlimg' alt=''>);
                                // $("#form-submit").click(function () {
                                //     // alert(111);
                                //     msg += "<div>"
                                //         + "<img src=\"urlimg\" >"
                                //     msg += "</div>";
                                //     $("#form-submit").html(msg);
                                // })

                                $(".main1").click(function () {
                                    $(".qrcode").show();
                                });

                                // $(function () {
                                //     $(".main1").click(function () {
                                //         // alert(1111);
                                //         $("#qrcode").fadeIn("slow");
                                //     });
                                //     $("#qrcode").click(function () {
                                //         $("#qrcode").fadeOut("slow");
                                //     })
                                // });

                                $(".image").attr('src', urlimg);


                            } else if (data.status == 400) {
                                // console.log(res);
                                alert('aaaa');
                                // location.href = "./table-list.html";

                            } else {
                                // alert("111");
                            }
                        },
                        error: function () {
                            console.log("请求出错！");
                        }
                    });

                });


            </script>

        </div>

        <div class="row-content am-cf">

        </div>
    </div>
    </div>
    </div>
    <script src="assets/js/amazeui.min.js"></script>
    <script src="assets/js/amazeui.datatables.min.js"></script>
    <script src="assets/js/dataTables.responsive.min.js"></script>
    <script src="assets/js/app.js"></script>
    <script>
                // /IndexViews/Logout/
        // function doLogout() {
            // var data = {};
            //配置的登出的url，
            // $.post('/../IndexViews/Logout/', data, function (resp) {
            //     console.log(resp);
            //     if (resp.code == 200) {
            //         alert('退出成功');
            //         // window.location.href = "../index.html";
            //     } else {
            //         alert(resp.msg);
            //     }
            // });
        //     $.ajax({
        //         type: "POST",
        //         url: "/../IndexViews/LoginOut/",
        //         // data:$("form").serialize(),
        //         dataType: 'json',
        //         success: function (data) {
        //             console.log(data);
        //             if (data.status == 200) {
        //                 alert(data.info);
        //                 // window.location.href="{:url('index/index')}";
        //             } else {
        //                 alert(data.info);
        //             }
        //         }
        //     });
        // }

        // $(function () {
        //     $("#logout").on('click', function (event) {
        //         $.ajax({
        //             type: "POST",
        //             url: "/../IndexViews/Logout/",
        //             // data:$("form").serialize(),
        //             dataType: 'json',
        //             success: function (data) {
        //                 if (data.status == 200) {
        //                     alert(data.info);
        //                     // window.location.href="{:url('index/index')}";
        //                 } else {
        //                     alert(data.info);
        //                 }
        //             }
        //         });
        //     })
        // })

        // $(function () {
        //     $.ajax({
        //         url: "/../IndexViews/User/",//ajax请求要发送的地址
        //         dataType: "json",//响应数据的类型
        //         type: "POST",//发送请求的方式
        //         success: function (data) {
        //             //data为服务器端响应的数据
        //             rs = data;
        //             if (rs.status == "400") {
        //                 window.location.href = "../login.html";
        //             }
        //         }
        //     });
        // })

    </script>
</body>

</html>